#! Example potential energy surface scan and CP-correction for Ne2

molecule dimer {
  Ne
--
  Ne 1 R
}

Rvals=[2.5, 3.0, 4.0]


set basis aug-cc-pVDZ
set freeze_core True

if psi4.core.get_option("scf", "orbital_optimizer_package") != "INTERNAL":
    psi4.set_options({"e_convergence": 9, "d_convergence": 5e-8})

# Initialize a blank dictionary of counterpoise corrected energies
# (Need this for the syntax below to work)
ecp = {}

for R in Rvals:
   dimer.R = R
   ecp[R] = energy('ccsd(t)', bsse_type = 'cp')

psi4.print_out("\n")
psi4.print_out("CP-corrected CCSD(T)/aug-cc-pVDZ interaction energies\n\n")
psi4.print_out("        R [Ang]         E_int [kcal/mol]             \n")
psi4.print_out("-----------------------------------------------------\n")
for R in Rvals:
   e = ecp[R] * psi_hartree2kcalmol
   psi4.print_out("        %3.1f            %10.6f\n" % (R, e))

