from __future__ import print_function
#! SCF cc-pVDZ geometry optimzation, with Z-matrix input

# This value is from a tightly converged QChem run  

molecule h2o {
     O
     H 1 1.0
     H 1 1.0 2 104.5
}

set {
  diis false
  basis cc-pvdz
  e_convergence 10
  d_convergence 10
  g_convergence gau_tight
  scf_type pk
}

if psi4.core.get_option("scf", "orbital_optimizer_package") != "INTERNAL":
    psi4.set_options({"e_convergence": 9, "d_convergence": 5e-8})

thisenergy = optimize('scf')

print(h2o.nuclear_repulsion_energy())
print(thisenergy)

