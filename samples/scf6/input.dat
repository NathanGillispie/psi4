#! Tests RHF/ROHF/UHF SCF gradients


molecule h2o {
0 1
O
H 1 R
H 1 R 2 A

R = 1.0
A = 104.5
}

set {
   reference rhf
   basis cc-pvdz
   e_convergence 8
   d_convergence 8
}

analytic, wfn = gradient('scf', return_wfn=True)


set findif points 3
findif = gradient('scf', dertype=0)


set findif points 5
findif = gradient('scf', dertype=0)


molecule h2o {
0 3
O
H 1 R
H 1 R 2 A

R = 1.0
A = 104.5
}

set {
   reference rohf
   basis cc-pvdz
}

analytic, wfn = gradient('scf', return_wfn=True)


set findif points 3
findif = gradient('scf', dertype=0)


set findif points 5
findif = gradient('scf', dertype=0)


molecule h2o {
0 3
O
H 1 R
H 1 R 2 A

R = 1.0
A = 104.5
}

set {
   reference uhf
   basis cc-pvdz
}

if psi4.core.get_option("scf", "orbital_optimizer_package") != "INTERNAL":
    psi4.set_options({"e_convergence": 9, "d_convergence": 5e-8})

analytic, wfn = gradient('scf', return_wfn=True)


set findif points 3
findif = gradient('scf', dertype=0)


set findif points 5
findif = gradient('scf', dertype=0)


