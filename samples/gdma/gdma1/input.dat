#! Water RHF/cc-pVTZ distributed multipole analysis

molecule water {
    O  0.000000  0.000000  0.117176
    H -0.000000 -0.756950 -0.468706
    H -0.000000  0.756950 -0.468706
 noreorient # These are not needed, but are used here to guarantee that the
 nocom      # GDMA origin placement defined below is at the O atom.
}

set {
    scf_type pk
    basis cc-pvtz
    d_convergence 10
    gdma_switch   0
    gdma_radius   [ "H", 0.65 ]
    gdma_limit    2
    gdma_origin   [ 0.000000,  0.000000,  0.117176 ]
}

if psi4.core.get_option("scf", "orbital_optimizer_package") == "INTERNAL":
    dma_tol = 6
else:
    dma_tol = 2e-6
    psi4.set_options({"e_convergence": 9, "d_convergence": 3e-8})

energy, wfn = energy('scf', return_wfn=True)

gdma(wfn)
dmavals = variable("DMA DISTRIBUTED MULTIPOLES")
totvals = variable("DMA TOTAL MULTIPOLES")
totvals_wfn = wfn.variable("DMA TOTAL MULTIPOLES")
